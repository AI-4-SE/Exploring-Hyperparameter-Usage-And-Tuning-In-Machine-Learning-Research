{
    "data_list.py": {
        "torch": {}
    },
    "my_loss.py": {
        "torch": {
            "sum_12": {
                "variable": {
                    "value": "entropy",
                    "type": "Name",
                    "possible_values": []
                },
                "input": {
                    "value": "entropy",
                    "type": "Name",
                    "possible_values": [
                        [
                            "-input_ * torch.log(input_ + 1e-07)",
                            "BinOp"
                        ],
                        [
                            "torch.sum(entropy, dim=1)",
                            "Call"
                        ],
                        [
                            "1.0 + torch.exp(-entropy)",
                            "BinOp"
                        ],
                        [
                            "torch.ones(ad_out.size(0)).cuda()",
                            "Call"
                        ],
                        [
                            "None",
                            "MethodArgument"
                        ]
                    ]
                },
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "from_numpy_23": {
                "variable": {
                    "value": "dc_target",
                    "type": "Name",
                    "possible_values": []
                },
                "ndarray": {
                    "value": "np.array([[1]] * train_bs + [[0]] * (train_bs + len_share))",
                    "type": "Call",
                    "possible_values": []
                }
            },
            "ones_like_30": {
                "variable": {
                    "value": "source_mask",
                    "type": "Name",
                    "possible_values": []
                },
                "input": {
                    "value": "entropy",
                    "type": "Name",
                    "possible_values": [
                        [
                            "-input_ * torch.log(input_ + 1e-07)",
                            "BinOp"
                        ],
                        [
                            "torch.sum(entropy, dim=1)",
                            "Call"
                        ],
                        [
                            "1.0 + torch.exp(-entropy)",
                            "BinOp"
                        ],
                        [
                            "torch.ones(ad_out.size(0)).cuda()",
                            "Call"
                        ],
                        [
                            "None",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "ones_like_35": {
                "variable": {
                    "value": "target_mask",
                    "type": "Name",
                    "possible_values": []
                },
                "input": {
                    "value": "entropy",
                    "type": "Name",
                    "possible_values": [
                        [
                            "-input_ * torch.log(input_ + 1e-07)",
                            "BinOp"
                        ],
                        [
                            "torch.sum(entropy, dim=1)",
                            "Call"
                        ],
                        [
                            "1.0 + torch.exp(-entropy)",
                            "BinOp"
                        ],
                        [
                            "torch.ones(ad_out.size(0)).cuda()",
                            "Call"
                        ],
                        [
                            "None",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "softmax_50": {
                "variable": {
                    "value": "yHat",
                    "type": "Name",
                    "possible_values": []
                },
                "input": {
                    "value": "yHat",
                    "type": "Name",
                    "possible_values": [
                        [
                            "F.softmax(yHat, dim=1)",
                            "Call"
                        ]
                    ]
                },
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "gather_51": {
                "variable": {
                    "value": "Yg",
                    "type": "Name",
                    "possible_values": []
                },
                "input": {
                    "value": "yHat",
                    "type": "Name",
                    "possible_values": [
                        [
                            "F.softmax(yHat, dim=1)",
                            "Call"
                        ]
                    ]
                },
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                },
                "index": {
                    "value": "torch.unsqueeze(y, 1)",
                    "type": "Call",
                    "possible_values": []
                }
            },
            "log_54": {
                "variable": {
                    "value": "Px_log",
                    "type": "Name",
                    "possible_values": []
                },
                "input": {
                    "value": "Px + 1e-10",
                    "type": "BinOp",
                    "possible_values": []
                }
            },
            "ones_55": {
                "variable": {
                    "value": "y_zerohot",
                    "type": "Name",
                    "possible_values": []
                },
                "*size": {
                    "value": "batch_size",
                    "type": "Name",
                    "possible_values": [
                        [
                            "len(y)",
                            "Call"
                        ]
                    ]
                },
                "out": {
                    "value": "classes",
                    "type": "Name",
                    "possible_values": [
                        [
                            "classes",
                            "Name"
                        ],
                        [
                            "65",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "ones_28": {
                "variable": {
                    "value": "entropy",
                    "type": "Name",
                    "possible_values": []
                },
                "*size": {
                    "value": "ad_out.size(0)",
                    "type": "Call",
                    "possible_values": []
                }
            },
            "log_11": {
                "input": {
                    "value": "input_ + 1e-07",
                    "type": "BinOp",
                    "possible_values": []
                }
            },
            "sum_45": {
                "input": {
                    "value": "weight",
                    "type": "Name",
                    "possible_values": [
                        [
                            "(1.0 + len_share / train_bs) * source_weight / torch.sum(source_weight).detach().item() + target_weight / torch.sum(target_weight).detach().item()",
                            "BinOp"
                        ],
                        [
                            "weight.view(-1, 1)",
                            "Call"
                        ],
                        [
                            "weight * (Yg_.view(len(yHat)) / Yg_.sum())",
                            "BinOp"
                        ],
                        [
                            "Yg_.view(len(yHat)) / Yg_.sum()",
                            "BinOp"
                        ],
                        [
                            "weight.detach()",
                            "Call"
                        ],
                        [
                            "None",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "unsqueeze_51": {
                "input": {
                    "value": "y",
                    "type": "Name",
                    "possible_values": []
                },
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "sum_59": {
                "input": {
                    "value": "output",
                    "type": "Name",
                    "possible_values": [
                        [
                            "Px * Px_log * y_zerohot.cuda()",
                            "BinOp"
                        ]
                    ]
                },
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "sum_67": {
                "input": {
                    "value": "weight",
                    "type": "Name",
                    "possible_values": [
                        [
                            "(1.0 + len_share / train_bs) * source_weight / torch.sum(source_weight).detach().item() + target_weight / torch.sum(target_weight).detach().item()",
                            "BinOp"
                        ],
                        [
                            "weight.view(-1, 1)",
                            "Call"
                        ],
                        [
                            "weight * (Yg_.view(len(yHat)) / Yg_.sum())",
                            "BinOp"
                        ],
                        [
                            "Yg_.view(len(yHat)) / Yg_.sum()",
                            "BinOp"
                        ],
                        [
                            "weight.detach()",
                            "Call"
                        ],
                        [
                            "None",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "exp_26": {
                "input": {
                    "value": "-entropy",
                    "type": "UnaryOp",
                    "possible_values": []
                }
            },
            "sum_41": {
                "input": {
                    "value": "source_weight",
                    "type": "Name",
                    "possible_values": [
                        [
                            "entropy * source_mask",
                            "BinOp"
                        ],
                        [
                            "source_weight * cls_weight",
                            "BinOp"
                        ]
                    ]
                }
            },
            "sum_42": {
                "input": {
                    "value": "target_weight",
                    "type": "Name",
                    "possible_values": [
                        [
                            "entropy * target_mask",
                            "BinOp"
                        ],
                        [
                            "target_weight * cls_weight",
                            "BinOp"
                        ]
                    ]
                }
            },
            "BCELoss_45": {
                "reduction": {
                    "value": "none",
                    "type": "Constant",
                    "possible_values": []
                }
            }
        }
    },
    "network.py": {
        "torch": {
            "Sequential_46": {
                "variable": {
                    "value": "self.feature_layers",
                    "type": "Attribute",
                    "possible_values": []
                },
                "*args": {
                    "value": "self.conv1",
                    "type": null,
                    "possible_values": []
                }
            },
            "Sequential_96": {
                "variable": {
                    "value": "self.classifier",
                    "type": "Attribute",
                    "possible_values": []
                },
                "params": {
                    "value": "default",
                    "type": null,
                    "possible_values": []
                }
            },
            "Sequential_99": {
                "variable": {
                    "value": "self.feature_layers",
                    "type": "Attribute",
                    "possible_values": []
                },
                "*args": {
                    "value": "self.features",
                    "type": null,
                    "possible_values": []
                }
            },
            "Linear_149": {
                "variable": {
                    "value": "self.ad_layer1",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "in_feature",
                    "type": "Name",
                    "possible_values": []
                },
                "out_features": {
                    "value": "hidden_size",
                    "type": "Name",
                    "possible_values": []
                }
            },
            "Linear_150": {
                "variable": {
                    "value": "self.ad_layer2",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "hidden_size",
                    "type": "Name",
                    "possible_values": []
                },
                "out_features": {
                    "value": "hidden_size",
                    "type": "Name",
                    "possible_values": []
                }
            },
            "Linear_151": {
                "variable": {
                    "value": "self.ad_layer3",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "hidden_size",
                    "type": "Name",
                    "possible_values": []
                },
                "out_features": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "ReLU_152": {
                "variable": {
                    "value": "self.relu1",
                    "type": "Attribute",
                    "possible_values": []
                },
                "params": {
                    "value": "default",
                    "type": null,
                    "possible_values": []
                }
            },
            "ReLU_153": {
                "variable": {
                    "value": "self.relu2",
                    "type": "Attribute",
                    "possible_values": []
                },
                "params": {
                    "value": "default",
                    "type": null,
                    "possible_values": []
                }
            },
            "Dropout_154": {
                "variable": {
                    "value": "self.dropout1",
                    "type": "Attribute",
                    "possible_values": []
                },
                "p": {
                    "value": "0.5",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "Dropout_155": {
                "variable": {
                    "value": "self.dropout2",
                    "type": "Attribute",
                    "possible_values": []
                },
                "p": {
                    "value": "0.5",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "Sigmoid_156": {
                "variable": {
                    "value": "self.sigmoid",
                    "type": "Attribute",
                    "possible_values": []
                },
                "params": {
                    "value": "default",
                    "type": null,
                    "possible_values": []
                }
            },
            "Linear_53": {
                "variable": {
                    "value": "self.bottleneck",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "model_resnet.fc.in_features",
                    "type": "Attribute",
                    "possible_values": []
                },
                "out_features": {
                    "value": "bottleneck_dim",
                    "type": "Name",
                    "possible_values": [
                        [
                            "256",
                            "MethodArgument"
                        ],
                        [
                            "256",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "Linear_54": {
                "variable": {
                    "value": "self.fc",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "bottleneck_dim",
                    "type": "Name",
                    "possible_values": [
                        [
                            "256",
                            "MethodArgument"
                        ],
                        [
                            "256",
                            "MethodArgument"
                        ]
                    ]
                },
                "out_features": {
                    "value": "class_num",
                    "type": "Name",
                    "possible_values": [
                        [
                            "1000",
                            "MethodArgument"
                        ],
                        [
                            "1000",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "Linear_59": {
                "variable": {
                    "value": "self.fc",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "model_resnet.fc.in_features",
                    "type": "Attribute",
                    "possible_values": []
                },
                "out_features": {
                    "value": "class_num",
                    "type": "Name",
                    "possible_values": [
                        [
                            "1000",
                            "MethodArgument"
                        ],
                        [
                            "1000",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "Linear_105": {
                "variable": {
                    "value": "self.bottleneck",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "4096",
                    "type": "Constant",
                    "possible_values": []
                },
                "out_features": {
                    "value": "bottleneck_dim",
                    "type": "Name",
                    "possible_values": [
                        [
                            "256",
                            "MethodArgument"
                        ],
                        [
                            "256",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "Linear_106": {
                "variable": {
                    "value": "self.fc",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "bottleneck_dim",
                    "type": "Name",
                    "possible_values": [
                        [
                            "256",
                            "MethodArgument"
                        ],
                        [
                            "256",
                            "MethodArgument"
                        ]
                    ]
                },
                "out_features": {
                    "value": "class_num",
                    "type": "Name",
                    "possible_values": [
                        [
                            "1000",
                            "MethodArgument"
                        ],
                        [
                            "1000",
                            "MethodArgument"
                        ]
                    ]
                }
            },
            "Linear_111": {
                "variable": {
                    "value": "self.fc",
                    "type": "Attribute",
                    "possible_values": []
                },
                "in_features": {
                    "value": "4096",
                    "type": "Constant",
                    "possible_values": []
                },
                "out_features": {
                    "value": "class_num",
                    "type": "Name",
                    "possible_values": [
                        [
                            "1000",
                            "MethodArgument"
                        ],
                        [
                            "1000",
                            "MethodArgument"
                        ]
                    ]
                }
            }
        }
    },
    "run_partial.py": {
        "torch": {
            "max_44": {
                "variable": {
                    "value": "(_, predict)",
                    "type": "Tuple",
                    "possible_values": []
                },
                "input": {
                    "value": "all_output",
                    "type": "Name",
                    "possible_values": [
                        [
                            "outputs.float().cpu()",
                            "Call"
                        ],
                        [
                            "torch.cat((all_output, outputs.float().cpu()), 0)",
                            "Call"
                        ]
                    ]
                }
            },
            "sum_48": {
                "variable": {
                    "value": "hist_tar",
                    "type": "Name",
                    "possible_values": []
                },
                "dim": {
                    "value": "0",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "DataLoader_62": {
                "variable": {
                    "value": "dset_loaders[source]",
                    "type": "Subscript",
                    "possible_values": []
                },
                "dataset": {
                    "value": "dsets['source']",
                    "type": "Subscript",
                    "possible_values": []
                },
                "batch_size": {
                    "value": "train_bs",
                    "type": "Name",
                    "possible_values": []
                },
                "shuffle": {
                    "value": "True",
                    "type": "Constant",
                    "possible_values": []
                },
                "num_workers": {
                    "value": "args.worker",
                    "type": "Attribute",
                    "possible_values": []
                },
                "drop_last": {
                    "value": "True",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "DataLoader_63": {
                "variable": {
                    "value": "dset_loaders[target]",
                    "type": "Subscript",
                    "possible_values": []
                },
                "dataset": {
                    "value": "dsets['target']",
                    "type": "Subscript",
                    "possible_values": []
                },
                "batch_size": {
                    "value": "train_bs",
                    "type": "Name",
                    "possible_values": []
                },
                "shuffle": {
                    "value": "True",
                    "type": "Constant",
                    "possible_values": []
                },
                "num_workers": {
                    "value": "args.worker",
                    "type": "Attribute",
                    "possible_values": []
                },
                "drop_last": {
                    "value": "True",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "DataLoader_64": {
                "variable": {
                    "value": "dset_loaders[test]",
                    "type": "Subscript",
                    "possible_values": []
                },
                "dataset": {
                    "value": "dsets['test']",
                    "type": "Subscript",
                    "possible_values": []
                },
                "batch_size": {
                    "value": "test_bs",
                    "type": "Name",
                    "possible_values": []
                },
                "shuffle": {
                    "value": "False",
                    "type": "Constant",
                    "possible_values": []
                },
                "num_workers": {
                    "value": "args.worker",
                    "type": "Attribute",
                    "possible_values": []
                }
            },
            "ones_169": {
                "variable": {
                    "value": "cls_weight",
                    "type": "Name",
                    "possible_values": []
                },
                "*size": {
                    "value": "outputs.size(0)",
                    "type": "Call",
                    "possible_values": []
                }
            },
            "mean_188": {
                "variable": {
                    "value": "tar_loss",
                    "type": "Name",
                    "possible_values": []
                },
                "input": {
                    "value": "my_loss.Entropy(softmax_tar_out)",
                    "type": "Call",
                    "possible_values": []
                }
            },
            "save_202": {
                "obj": {
                    "value": "best_model",
                    "type": "Name",
                    "possible_values": [
                        [
                            "base_network.state_dict()",
                            "Call"
                        ]
                    ]
                },
                "f": {
                    "value": "os.path.join(args.output_dir, 'best_model.pt')",
                    "type": "Call",
                    "possible_values": []
                }
            },
            "manual_seed_264": {
                "seed": {
                    "value": "args.seed",
                    "type": "Attribute",
                    "possible_values": []
                }
            },
            "manual_seed_265": {
                "seed": {
                    "value": "args.seed",
                    "type": "Attribute",
                    "possible_values": []
                }
            },
            "no_grad_29": {
                "params": {
                    "value": "default",
                    "type": null,
                    "possible_values": []
                }
            },
            "sum_45": {
                "input": {
                    "value": "torch.squeeze(predict).float() == all_label",
                    "type": "Compare",
                    "possible_values": []
                }
            },
            "cat_163": {
                "variable": {
                    "value": "features",
                    "type": "Name",
                    "possible_values": []
                },
                "tensors": {
                    "value": "(features_source, features_target, features_middle)",
                    "type": "Tuple",
                    "possible_values": []
                },
                "dim": {
                    "value": "0",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "cat_164": {
                "variable": {
                    "value": "outputs",
                    "type": "Name",
                    "possible_values": []
                },
                "tensors": {
                    "value": "(outputs_source, outputs_target, outputs_middle)",
                    "type": "Tuple",
                    "possible_values": []
                },
                "dim": {
                    "value": "0",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "cat_166": {
                "variable": {
                    "value": "features",
                    "type": "Name",
                    "possible_values": []
                },
                "tensors": {
                    "value": "(features_source, features_target)",
                    "type": "Tuple",
                    "possible_values": []
                },
                "dim": {
                    "value": "0",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "cat_167": {
                "variable": {
                    "value": "outputs",
                    "type": "Name",
                    "possible_values": []
                },
                "tensors": {
                    "value": "(outputs_source, outputs_target)",
                    "type": "Tuple",
                    "possible_values": []
                },
                "dim": {
                    "value": "0",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "cat_42": {
                "variable": {
                    "value": "all_output",
                    "type": "Name",
                    "possible_values": []
                },
                "tensors": {
                    "value": "(all_output, outputs.float().cpu())",
                    "type": "Tuple",
                    "possible_values": []
                },
                "dim": {
                    "value": "0",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "cat_43": {
                "variable": {
                    "value": "all_label",
                    "type": "Name",
                    "possible_values": []
                },
                "tensors": {
                    "value": "(all_label, labels.float())",
                    "type": "Tuple",
                    "possible_values": []
                },
                "dim": {
                    "value": "0",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "DataLoader_138": {
                "variable": {
                    "value": "dset_loaders[middle]",
                    "type": "Subscript",
                    "possible_values": []
                },
                "dataset": {
                    "value": "dsets['source']",
                    "type": "Subscript",
                    "possible_values": []
                },
                "batch_size": {
                    "value": "len_share",
                    "type": "Name",
                    "possible_values": [
                        [
                            "int(max(0, train_bs // args.mu * (1 - epoch / total_epochs)))",
                            "Call"
                        ],
                        [
                            "0",
                            "Constant"
                        ],
                        [
                            "int(train_bs // abs(args.mu))",
                            "Call"
                        ]
                    ]
                },
                "shuffle": {
                    "value": "True",
                    "type": "Constant",
                    "possible_values": []
                },
                "num_workers": {
                    "value": "args.worker",
                    "type": "Attribute",
                    "possible_values": []
                },
                "drop_last": {
                    "value": "True",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "Softmax_183": {
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "Softmax_187": {
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "mean_46": {
                "input": {
                    "value": "my_loss.Entropy(torch.nn.Softmax(dim=1)(all_output))",
                    "type": "Call",
                    "possible_values": []
                }
            },
            "Softmax_48": {
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "CrossEntropyLoss_177": {
                "reduction": {
                    "value": "none",
                    "type": "Constant",
                    "possible_values": []
                }
            },
            "sum_179": {
                "input": {
                    "value": "weight",
                    "type": "Name",
                    "possible_values": [
                        [
                            "class_weight[labels_source].detach()",
                            "Call"
                        ]
                    ]
                }
            },
            "CrossEntropyLoss_181": {
                "params": {
                    "value": "default",
                    "type": null,
                    "possible_values": []
                }
            },
            "squeeze_45": {
                "input": {
                    "value": "predict",
                    "type": "Name",
                    "possible_values": []
                }
            },
            "Softmax_46": {
                "dim": {
                    "value": "1",
                    "type": "Constant",
                    "possible_values": []
                }
            }
        }
    }
}